/* | https://webnalist.com | v1.0.0 | Copyright (c) 2015 Webnalist Sp. z o.o. All rights reserved. | */
!function(e,t){e.matches=e.matches||e[t+"MatchesSelector"]||function(e){for(var t=this,r=(t.document||t.ownerDocument).querySelectorAll(e),n=0;r[n]&&r[n]!==t;)++n;return r[n]?!0:!1},e.closest=e.closest||function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}}(Element.prototype,(this.getComputedStyle&&[].join.call(getComputedStyle(document.documentElement,"")).match(/-(moz|ms|webkit)-/)||[])[1]);var WN=WN||{};WN.Ajax=function(){return{request:function(e){"string"==typeof e&&(e={url:e}),e.url=e.url||"",e.method=e.method||"get",e.data=e.data||{};var t=function(e,t){var r,n=[];for(var o in e)n.push(o+"="+encodeURIComponent(e[o]));return r=n.join("&"),""!=r?t?t.indexOf("?")<0?"?"+r:"&"+r:r:""},r={host:{},process:function(e){var r=this;return this.xhr=null,window.ActiveXObject?this.xhr=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),this.xhr&&(this.xhr.onreadystatechange=function(){if(4==r.xhr.readyState&&200==r.xhr.status){var t=r.xhr.responseText;e.json===!0&&"undefined"!=typeof JSON&&(t=JSON.parse(t)),r.doneCallback&&r.doneCallback.apply(r.host,[t,r.xhr])}else 4==r.xhr.readyState&&r.failCallback&&r.failCallback.apply(r.host,[r.xhr]);r.alwaysCallback&&r.alwaysCallback.apply(r.host,[r.xhr])}),"get"==e.method?(this.xhr.open("GET",e.url+t(e.data,e.url),!0),this.setHeaders({"X-Requested-With":"XMLHttpRequest"})):(this.xhr.open(e.method,e.url,!0),this.setHeaders({"X-Requested-With":"XMLHttpRequest","Content-type":"application/x-www-form-urlencoded"})),e.headers&&"object"==typeof e.headers&&this.setHeaders(e.headers),setTimeout(function(){"get"==e.method?r.xhr.send():r.xhr.send(t(e.data))},20),this},done:function(e){return this.doneCallback=e,this},fail:function(e){return this.failCallback=e,this},always:function(e){return this.alwaysCallback=e,this},setHeaders:function(e){for(var t in e)this.xhr&&this.xhr.setRequestHeader(t,e[t])}};return r.process(e)}}}();var WN=WN||{};WN=function(e,t,r){function n(){h(g.articleItemSelector,"click",function(t){var r=t.target.closest(g.articleItemSelector).getAttribute(g.articleUrlAttribute),n=360,o=440,a=screen.width/2-n/2,i=screen.height/2-o/2,l=g.readArticleUrl+"?url="+encodeURIComponent(r),s=["toolbar=no","location=no","directories=no","status=no","menubar=no","scrollbars=yes","resizable=no","copyhistory=no","width="+n,"height="+o,"top="+i,"left="+a];c=e.open(l,null,s.join(",")),c.focus()})}function o(){var e={},t=0,n=function(e){var t=0;for(var r in e)t++;return t};u(g.articleItemSelector+":not(."+g.articleItemLoadedClass+")").forEach(function(r){var n=r.getAttribute(g.articleUrlAttribute),o=s(g.priceSelector,r);n&&(e["url["+t+"]"]=n,t++),o&&f(o,g.loadingClass)}),n(e)&&r.Ajax.request({url:g.loadPricesUrl,method:"post",data:e}).done(function(e){a(JSON.parse(e))})}function a(e){for(var t in e){var r=g.articleItemSelector+"["+g.articleUrlAttribute+'="'+t+'"]';u(r+":not(."+g.articleItemLoadedClass+")").forEach(function(r){f(r,g.articleItemLoadedClass);var n=s(g.priceSelector,r);n&&(m(n,l(e[t]/100)),p(n,g.loadingClass))})}u(g.articleItemSelector+":not(."+g.articleItemLoadedClass+") ."+g.loadingClass).forEach(function(e){m(e,g.noPriceLabel),p(e,g.loadingClass)})}function i(e,t,r,n,o){var a="\\d(?=(\\d{"+(r||3)+"})+"+(t>0?"\\D":"$")+")",i=e.toFixed(Math.max(0,~~t));return(o?i.replace(".",o):i).replace(new RegExp(a,"g"),"$&"+(n||","))}function l(e){return i(e,2,3," ",",")}var c,s=function(e,r){return(r||t).querySelector(e)},u=function(e,r){return(r||t).querySelectorAll(e)},d=function(e,t,r,n){e.addEventListener(t,r,!!n)},h=function(){var e={},r=function(t){var r=t.target;e[t.type].forEach(function(e){var n=u(e.selector),o=Array.prototype.indexOf.call(n,r.closest(e.selector))>=0;o&&e.handler.call(r,t)})};return function(n,o,a){e[o]||(e[o]=[],d(t.documentElement,o,r,!0)),e[o].push({selector:n,handler:a})}}(),f=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},p=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},m=function(e,t){e.innerHTML=t},b=function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var r in arguments[t])arguments[t].hasOwnProperty(r)&&(e[r]=arguments[t][r]);return e},y=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)},x=function(e){return y(e)&&e.constructor===Object},w={readArticleUrl:"https://webnalist.com/articles/read/confirm",loadPricesUrl:"https://webnalist.com/public/merchant/articles/prices.json",articleItemSelector:".wn-item",articleItemLoadedClass:"wn-item-loaded",priceSelector:".wn-price",loadingClass:"wn-loading",articleUrlAttribute:"data-wn-url",wrapperSelector:"",noPriceLabel:"--",loadPrices:!1},g=r.options=b(w,r.options||{});if(g.wrapperSelector&&(g.articleItemSelector=g.wrapperSelector+" "+g.articleItemSelector),g.sandbox){var v="http://demo.webnalist.com";x(g.sandbox)&&g.sandbox.url&&(v=g.sandbox.url),g.readArticleUrl=v+"/sandbox/confirm.php",g.loadPricesUrl=v+"/sandbox/prices.php",console.log(g.loadPricesUrl)}NodeList.prototype.forEach=Array.prototype.forEach;var C=r.ready=function(e){"loading"!=t.readyState?e():t.addEventListener("DOMContentLoaded",e)},S=e.WN;return r.noConflict=function(){return e.WN===r&&(e.WN=S),r},C(function(){n(),g.loadPrices&&o()}),b(r,{formatPrice:l,getArticlesPrices:o})}(window,document,WN);