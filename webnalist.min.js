/* | https://webnalist.com | v1.0.0 | Copyright (c) 2015 Webnalist Sp. z o.o. All rights reserved. | */
!function(e,t){e.matches=e.matches||e[t+"MatchesSelector"]||function(e){for(var t=this,r=(t.document||t.ownerDocument).querySelectorAll(e),n=0;r[n]&&r[n]!==t;)++n;return r[n]?!0:!1},e.closest=e.closest||function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}}(Element.prototype,(this.getComputedStyle&&[].join.call(getComputedStyle(document.documentElement,"")).match(/-(moz|ms|webkit)-/)||[])[1]);var WN=WN||{};WN.Ajax=function(){return{request:function(e){"string"==typeof e&&(e={url:e}),e.url=e.url||"",e.method=e.method||"get",e.data=e.data||{};var t=function(e,t){var r,n=[];for(var o in e)n.push(o+"="+encodeURIComponent(e[o]));return r=n.join("&"),""!=r?t?t.indexOf("?")<0?"?"+r:"&"+r:r:""},r={host:{},process:function(e){var r=this;return this.xhr=null,window.ActiveXObject?this.xhr=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),this.xhr&&(this.xhr.onreadystatechange=function(){if(4==r.xhr.readyState&&200==r.xhr.status){var t=r.xhr.responseText;e.json===!0&&"undefined"!=typeof JSON&&(t=JSON.parse(t)),r.doneCallback&&r.doneCallback.apply(r.host,[t,r.xhr])}else 4==r.xhr.readyState&&r.failCallback&&r.failCallback.apply(r.host,[r.xhr]);r.alwaysCallback&&r.alwaysCallback.apply(r.host,[r.xhr])}),"get"==e.method?(this.xhr.open("GET",e.url+t(e.data,e.url),!0),this.setHeaders({"X-Requested-With":"XMLHttpRequest"})):(this.xhr.open(e.method,e.url,!0),this.setHeaders({"X-Requested-With":"XMLHttpRequest","Content-type":"application/x-www-form-urlencoded"})),e.headers&&"object"==typeof e.headers&&this.setHeaders(e.headers),setTimeout(function(){"get"==e.method?r.xhr.send():r.xhr.send(t(e.data))},20),this},done:function(e){return this.doneCallback=e,this},fail:function(e){return this.failCallback=e,this},always:function(e){return this.alwaysCallback=e,this},setHeaders:function(e){for(var t in e)this.xhr&&this.xhr.setRequestHeader(t,e[t])}};return r.process(e)}}}();var WN=WN||{};WN=function(e,t,r){function n(){var r="click",n=!1,o=0,a=0,i=0,c=0,s=function(e){return e.targetTouches?e.targetTouches[0]:e},u=function(t){var r=t.target.closest(x.articleItemSelector),n=r.getAttribute(x.articleUrlAttribute)||r.getAttribute("href"),o=360,a=440,i=screen.width/2-o/2,c=screen.height/2-a/2,s=x.readArticleUrl+"?url="+encodeURIComponent(n),u=["toolbar=no","location=no","directories=no","status=no","menubar=no","scrollbars=yes","resizable=no","copyhistory=no","width="+o,"height="+a,"top="+c,"left="+i];l=e.open(s,null,u.join(",")),(!l||l.closed||"undefined"==typeof l.closed)&&(e.location.href=s),l.focus()};navigator.userAgent.match(/iPhone/i)&&(r="touchstart",d(t.body,"touchend",function(){n=!1}),d(t.body,"touchmove",function(e){var t=s(e);o=t.pageX,a=t.pageY})),h(x.articleItemSelector,r,function(e){if("touchstart"===r){var t=s(e);i=o=t.pageX,c=a=t.pageY,n=!0,setTimeout(function(){i!==o||n||c!==a||u(e)},200)}else u(e);e.preventDefault()})}function o(){var e={},t=0,n=function(e){var t=0;for(var r in e)t++;return t};u(x.articleItemSelector+":not(."+x.articleItemLoadedClass+")").forEach(function(r){var n=r.getAttribute(x.articleUrlAttribute),o=s(x.priceSelector,r);n&&(e["url["+t+"]"]=n,t++),o&&f(o,x.loadingClass)}),n(e)&&r.Ajax.request({url:x.loadPricesUrl,method:"post",data:e}).done(function(e){a(JSON.parse(e))})}function a(e){for(var t in e){var r=x.articleItemSelector+"["+x.articleUrlAttribute+'="'+t+'"]';u(r+":not(."+x.articleItemLoadedClass+")").forEach(function(r){f(r,x.articleItemLoadedClass);var n=s(x.priceSelector,r);n&&(m(n,c(e[t]/100)),p(n,x.loadingClass))})}u(x.articleItemSelector+":not(."+x.articleItemLoadedClass+") ."+x.loadingClass).forEach(function(e){m(e,x.noPriceLabel),p(e,x.loadingClass)})}function i(e,t,r,n,o){var a="\\d(?=(\\d{"+(r||3)+"})+"+(t>0?"\\D":"$")+")",i=e.toFixed(Math.max(0,~~t));return(o?i.replace(".",o):i).replace(new RegExp(a,"g"),"$&"+(n||","))}function c(e){return i(e,2,3," ",",")}var l,s=function(e,r){return(r||t).querySelector(e)},u=function(e,r){return(r||t).querySelectorAll(e)},d=function(e,t,r,n){e.addEventListener(t,r,!!n)},h=function(){var e={},r=function(t){var r=t.target;e[t.type].forEach(function(e){var n=u(e.selector),o=Array.prototype.indexOf.call(n,r.closest(e.selector))>=0;o&&e.handler.call(r,t)})};return function(n,o,a){e[o]||(e[o]=[],d(t.documentElement,o,r,!0)),e[o].push({selector:n,handler:a})}}(),f=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},p=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},m=function(e,t){e.innerHTML=t},b=function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var r in arguments[t])arguments[t].hasOwnProperty(r)&&(e[r]=arguments[t][r]);return e},g=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)},v=function(e){return g(e)&&e.constructor===Object},y={readArticleUrl:"https://webnalist.com/articles/read/confirm",loadPricesUrl:"https://webnalist.com/public/merchant/articles/prices.json",articleItemSelector:".wn-item",articleItemLoadedClass:"wn-item-loaded",priceSelector:".wn-price",loadingClass:"wn-loading",articleUrlAttribute:"data-wn-url",wrapperSelector:"",noPriceLabel:"--",loadPrices:!1},x=r.options=b(y,r.options||{});if(x.wrapperSelector&&(x.articleItemSelector=x.wrapperSelector+" "+x.articleItemSelector),x.sandbox){var w="http://demo.webnalist.com";v(x.sandbox)&&x.sandbox.url&&(w=x.sandbox.url),x.readArticleUrl=w+"/sandbox/confirm.php",x.loadPricesUrl=w+"/sandbox/prices.php",console.log(x.loadPricesUrl)}NodeList.prototype.forEach=Array.prototype.forEach;var C=r.ready=function(e){"loading"!=t.readyState?e():t.addEventListener("DOMContentLoaded",e)},S=e.WN;return r.noConflict=function(){return e.WN===r&&(e.WN=S),r},C(function(){n(),x.loadPrices&&o()}),b(r,{formatPrice:c,getArticlesPrices:o})}(window,document,WN);